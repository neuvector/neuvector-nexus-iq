package xcyclonedx

import "encoding/xml"

// SeverityType ...
type SeverityType string

// ScoreValueType ...
type ScoreValueType float64

// ScoreSourceType ...
type ScoreSourceType string

// Score ...
type Score struct {
	XMLName        xml.Name  `xml:"v:score"`
	Base           []float64 `xml:"v:base"`
	Impact         []float64 `xml:"v:impact"`
	Exploitability []float64 `xml:"v:exploitability"`
}

// ScoreType ...
type ScoreType struct {
	//XMLName  xml.Name `xml:"v:scoreType"`
	XMLName  xml.Name `xml:"v:rating"`
	Score    []*Score `xml:"v:score"`
	Severity []string `xml:"v:severity"`
	Method   []string `xml:"v:method"`
	Vector   []string `xml:"v:vector"`
}

// Source ...
type Source struct {
	XMLName  xml.Name `xml:"v:source"`
	NameAttr string   `xml:"name,attr"`
	Url      []string `xml:"v:url"`
}

// Ratings ...
type Ratings struct {
	XMLName xml.Name     `xml:"v:ratings"`
	Rating  []*ScoreType `xml:"v:rating"`
}

// Cwes ...
type Cwes struct {
	XMLName xml.Name `xml:"v:cwes"`
	Cwe     []int    `xml:"v:cwe"`
}

// Recommendations ...
type Recommendations struct {
	XMLName        xml.Name `xml:"v:recommendations"`
	Recommendation string   `xml:"v:recommendation"`
}

// Advisories ...
type Advisories struct {
	XMLName  xml.Name `xml:"v:advisories"`
	Advisory string   `xml:"v:advisory"`
}

// Vulnerability ...
type Vulnerability struct {
	XMLName         xml.Name           `xml:"v:vulnerability"`
	RefAttr         string             `xml:"ref,attr"`
	Id              []string           `xml:"v:id"`
	Source          []*Source          `xml:"v:source"`
	Ratings         []*Ratings         `xml:"v:ratings"`
	Cwes            []*Cwes            `xml:"v:cwes"`
	Description     []string           `xml:"v:description"`
	Recommendations []*Recommendations `xml:"v:recommendations"`
	Advisories      []*Advisories      `xml:"v:advisories"`
}

// Vulnerabilities ...
type Vulnerabilities struct {
	XMLName       xml.Name         `xml:"v:vulnerabilities"`
	Vulnerability []*Vulnerability `xml:"v:vulnerability"`
}
